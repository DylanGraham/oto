<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>


    <form>
        <input type="text" name="name" />
        <button>submit</button>
    </form>

    <body>
        <script>
            class GreeterService {
                async greet(greetRequest) {
                    const headers={
                        Accept: "application/json",
                        "Accept-Encoding": "gzip",
                        "Content-Type": "application/json"
                    };
                    greetRequest=greetRequest||{};
                    const response=await fetch(
                        "oto/GreeterService.Greet",
                        {
                            method: "POST",
                            headers: headers,
                            body: JSON.stringify(greetRequest)
                        }
                    );
                    return response.json().then(json => {
                        if (json.error) {
                            throw new Error(json.error);
                        }
                        return json;
                    });
                }
            }

            const g=new GreeterService();
            const form=document.querySelector("form");
            form.addEventListener("submit",e => {
                e.preventDefault();
                g.greet({name: e.target.name.value})
                    .then(v => alert(JSON.stringify(v)))
                    .catch(console.log);
            });
        </script>
    </body>
</html>